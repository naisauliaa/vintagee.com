<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keranjang</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .cart-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 10px;
        }
    </style>
</head>
<body class="bg-light">
    <header class="bg-dark text-white text-center py-3">
        <h1>Keranjang</h1>
    </header>
    <main class="container my-5">
        <section class="bg-white p-4 rounded shadow">
            <h2 class="mb-4">Keranjang Anda</h2>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Produk</th>
                            <th>Jumlah</th>
                            <th>Harga</th>
                            <th>Subtotal</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- isi keranjang akan dimasukkan di sini -->
                    </tbody>
                </table>
            </div>
            <div class="border-top pt-3">
                <h3 class="h5">Ringkasan Keranjang</h3>
                <p>Subtotal: Rp. </p>
                <p>Tax (5%): Rp. </p>
                <p>Total: Rp. </p>
            </div>
            <div class="d-flex justify-content-end mt-3">
                <button class="btn btn-dark me-2">Update Keranjang</button>
                <button class="btn btn-dark">Checkout</button>
            </div>
        </section>
    </main>
    <script>
        function loadCart() {
            const tbody = document.querySelector("tbody");
            tbody.innerHTML = "";

            let subtotal = 0;
            const products = JSON.parse(localStorage.getItem("cart")) || [];

            products.forEach((product, index) => {
                const row = document.createElement("tr");

                row.innerHTML = `
                    <td class="d-flex align-items-center">
                        <img src="${product.image}" alt="Gambar Produk">
                        <span class="ms-2">${product.name}</span>
                    </td>
                    <td>
                        <input type="number" class="form-control" value="${product.quantity}" min="1" onchange="updateQuantity(${index}, this.value)">
                    </td>
                    <td>Rp. ${product.price.toLocaleString()}</td>
                    <td>Rp. ${(product.price * product.quantity).toLocaleString()}</td>
                    <td>
                        <button class="btn btn-danger" onclick="removeFromCart(${index})">Hapus</button>
                    </td>
                `;

                tbody.appendChild(row);
                subtotal += product.price * product.quantity;
            });

            updateSummary(subtotal);
        }

        function updateQuantity(index, quantity) {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart[index].quantity = parseInt(quantity);
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }

        function removeFromCart(index) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart.splice(index, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }

        function updateSummary(subtotal) {
            const tax = subtotal * 0.05;
            const total = subtotal + tax;

            document.querySelector(".border-top p:nth-child(1)").textContent = `Subtotal: Rp. ${subtotal.toLocaleString()}`;
            document.querySelector(".border-top p:nth-child(2)").textContent = `Tax (5%): Rp. ${tax.toLocaleString()}`;
            document.querySelector(".border-top p:nth-child(3)").textContent = `Total: Rp. ${total.toLocaleString()}`;
        }

        document.addEventListener("DOMContentLoaded", loadCart);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
